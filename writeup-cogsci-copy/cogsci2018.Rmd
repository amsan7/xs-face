---
title: "Postural changes mediate children's visual access to social information"
bibliography: xsface.bib
csl: apa6.csl
document-params: "10pt, letterpaper"

author-information: > 
    \author{{\large \bf Alessandro Sanchez} \\ \texttt{author1@university.edu} \\ Department of Psychology \\ Stanford University
    \And {\large \bf Bria Long} \\ \texttt{bria@stanford.edu} \\ Department of Psychology \\ Stanford University
        \And {\large \bf Ally Kraus} \\ \texttt{bria@stanford.edu} \\ Department of Psychology \\ Stanford University
        \And {\large \bf Michael C. Frank} \\ \texttt{mcfrank@stanford.edu} \\ Department of Psychology \\ Stanford University}

# abstract: 
# The ability to process social cues (e.g., eye gaze) is a critical component of children's early language and cognitive development. However, as children reach their first birthday, they begin to locomote themselves, exploring their visual environment in an entirely new way. How do these postural changes affect children\'s access to the social information relevant for word-learning? Here, explore this question by using head-mounted cameras to record infants\' (8-16 months of age) egocentric visual perspective and by using computer-vision algorithms to detect the proportion of faces and hands in infants' environments.  We find that infant\'s postural changes largely mediate infants\' accesses to both faces and hands, suggesting that these postural and locomotive developments facilitate infants' emerging linguistic and social capacities.

keywords:
    "social cognition; face-perception; infancy; locomotion; head-cameras"
    
output: cogsci2016::cogsci_paper
---

```{r global_options, include=FALSE}
rm(list=ls())
knitr::opts_chunk$set(fig.width=3, fig.height=3, fig.crop = F, fig.pos = "tb", fig.path='figs/',
                      echo=F, warning=F, cache=F, message=F, sanitize = T)
```

```{r, libraries}
library(knitr)
knitr::opts_chunk$set(fig.width=6, fig.height=5, fig.crop = FALSE, 
                      fig.path='figs/', echo=FALSE, warning = FALSE, 
                      cache=TRUE, message = FALSE, sanitize = TRUE)
library(readr)
library(dplyr)
library(tidyr)
library(xtable)
library(lubridate)
library(langcog)
library(ggplot2)
library(lme4)
```
# Introduction
Children are remarkably skilled language learners, connecting arbitrary labels (“cup”) with specific visual concepts at a rapid pace through the first two years of life. However, children do not learn words in a vacuum but rather in a rich social environment, where social cues provided by speakers (e.g., eye-gaze) provide strong scaffolding for this learning process. Further, children’s ability to effectively process these social cues may be a key factor in their early language development.  In a longitudinal study, children’s level of joint engagement with their mother was found to predict both their receptive and productive vocabularies (@carpenter1998).  More recently, 10 month-olds who follow an adult’s gaze in an experimental context have larger vocabularies at 18 months (@brooks2005) and throughout the second year of life (@brooks2008). 

However, as children are learning their first words, their view of the world is also changing radically [@adolph2007]. Infant’s motor abilities improve dramatically near the end of the first year of life,  allowing them to locomote independently and to determine what they see. During spontaneous play in a laboratory playroom, toddlers are more likely to look at the floor while crawling than while walking (Franchak et al., 2011), when they have full visual access to their environment and the people in it (Kretch, Franchak, and Adolph, 2014). 

One possibility is that these motor improvements have strong developmental cascades, impacting children’s emerging social, cognitive, and linguistic abilities (Iverson, 2010). Indeed, these postural changes also impact how children interact with their mothers;  walking infants make different kinds of object-related bids for attention from their mothers than crawling infants, and tend to hear more action directed statements (e.g., “open it”).  (Karasik et al., 2014).  More directly, in an observational study, @walle2014 found that children who were able to walk had both higher receptive and productive vocabularies.  On their account, children’s ability to stand and independently locomote may fundamentally change their ability to access the social information (e.g., faces, gaze) relative to children who are still crawling and sitting. In other words, the ability to access more detailed social information may allow infants to learn words quicker and more efficiently, facilitating language growth.

Recent work has begun to use egocentric, head-mounted cameras to document the visual experiences of infants and children — which even for walking children are radically different than the adult perspective (and not easily predicted by our own adult intuitions; @franchak2011, @yoshida2008; @clerkin2017). Children’s views tend to be restricted and to be dominated by objects and hands much more than that of adults [@yoshida2008], and both computational and empirical work suggest that this restricted viewpoint may be more effective for learning what objects and their labels than the comparable adult perspective [@yurovsky2012, @bambach2017]. Further, recent work also suggests dramatic changes in the child’s perspective over the first two years of life, as views transition from primarily containing close up view of faces to capturing views of hands paired with the objects they are acting on [@fausey2017].

Here, we directly ask whether the postural changes that infants’ experience as they reach their first birthday change the availability of the social information relevant for word learning. To do so, we recorded the visual experience of a group of infants and children using head-mounted cameras during a brief laboratory free-play session; children’s posture and their orientation to their caregiver were also recorded from a third-person perspective and hand-annotated. We capitalize on recent improvements in computer vision algorithms (@citemtcnn, @openpose) that allow the automated detection of both faces and hands, and we analyze the frequency of both faces and hands in the child’s visual environment. 

# Methods
## Participants
```{r echo=FALSE, include=FALSE}
all_subs <- read.csv("../data/demographics/all_participants.csv") %>%
  rename(subid = subID)
inc_subs <- read.csv("../data/demographics/demographics.csv")
all_subs$inc <- all_subs$reason=="included"

inc_subs$len.min <- sapply(strsplit(as.character(inc_subs$len),":"),
       function(x) {
         x <- as.numeric(x)
         x[1]+x[2]/60
       }
)

all_subs %>% 
  group_by(reason) %>%
  summarise(n = n()) %>% 
  kable

all_subs %>%
  left_join(inc_subs) %>%
  group_by(age_group) %>%
  summarise(n = sum(inc), 
            percent_included = mean(inc),
            age = mean(age.at.test, na.rm=TRUE), 
            video_length = mean(len.min, na.rm=TRUE), 
            female = sum(gender=="female", na.rm=TRUE)) %>%
  xtable %>%
  print(digits = 2, include.rownames=FALSE,table.placement = "H", type="latex", comment = F)
```
Our final sample consisted of 36 infants and children, with 8 participants in three age groups: 8 months (6 females), 12 months (7 females), and 16 months (6 females). Participants were recruited from the surrounding community via state birth records, had no documented disabilities, and were reported to hear at least 80\% English at home. Demographics and exclusion rates are given in Table \ref{tab:pop}. 
\begin{table}[H]
\centering
\begin{tabular}{rrrrrr}
  \hline
 Group & N & \% incl. & Mean age & Videos length (min) \\ 
  \hline
   8 mo. &   12 & 0.46 & 8.71 & 14.41 \\ 
   12 mo. &  12 & 0.40 & 12.62 & 13.48 \\ 
   16 mo. &  12 & 0.31 & 16.29 & 15.00\\ 
   \hline
\end{tabular}
\caption{\label{tab:pop} Demographics by age group.}
\end{table}
To obtain this final sample, we tested `r length(all_subs$reason)`, excluding  `r sum(all_subs$reason!="included")` children for the following reasons:
`r sum(all_subs$reason=="HC technical error")` for technical issues related to the headcam,
`r sum(all_subs$reason=="would not wear camera")` for failing to wear the headcam,
`r sum(all_subs$reason=="less than 4 min HC footage")` for fewer than 4 minutes of headcam footage,
`r sum(all_subs$reason=="multiple people")` for having multiple adults present,
`r sum(all_subs$reason=="no CDI")` for missing CDI data,
`r sum(all_subs$reason=="no DV cam footage")` for missing scene camera footage,
`r sum(all_subs$reason=="infant crying")` for fussiness, and one excluded for sample symmetry. All inclusion decisions were made independent of the results of subsequent analyses.

## Head-mounted camera
We used a small, head-mounted camera ("headcam") that was constructed from a MD80 model camera attached to a soft elastic headband.Videos captured by the headcam were 720x480 pixels with 25 frames per second.Detailed instructions for creating this headcam can be found  at \url{http://babieslearninglanguage.blogspot.com/2013/10/how-to-make-babycam.html}. A fisheye lens was attached to the camera to cincrease the view angle from $32^{\circ}$ horizontal by $24^{\circ}$ vertical to $64^{\circ}$ horizontal by $46^{\circ}$ vertical (see Figure \ref{fig:headcam}, left). 

Even with the fish-eye lens, the vertical field of view of the camera is still considerably reduced compared to the child's approximate vertical field of view, which spans around 100--120$^{\circ}$ in the vertical dimension by 6-7 months of age [@mayer1988;@cummings1988]. As we were primarily interested in the presence of faces in the child's field of view, we chose to orient the camera upwards to capture the entirely of the child's upper visual field where the child is likely to see the faces of adults around them. This allowed us to maximize our chances of capturing faces that the child would have seen during the play session.

```{r image, fig.env = "figure", fig.pos = "H", fig.align='center', fig.width=2, fig.height=3, set.cap.width=T, num.cols.cap=1, fig.label="headcam", fig.cap = "Field of view for three different headcam configurations, with the device we used in the middle. The lowest camera is pictured for comparison, but was not available until after our study was already in progress."}
img <- png::readPNG("images/viewangle.png")
grid::grid.raster(img)
```

## Procedure

First, all parents signed consent documentsin a waiting room  where children were fitted with the headcam. After the child was comfortable in the waiting room and with the experimenter, the experimenter placed the headcam on the child's head. If the child was uninterested in wearing the headcam or tried to take it off, the experimenter presented engaging toys to try to draw the child's focus away from the headcam [@yoshida2008].

After the child was comfortable with wearing the headcam, the child and caregiver were shown to a playroom for the free-play session--the focus of the current study. Parents were shown a box containing three pairs of novel and familiar objects (e.g., a ball and a feather duster, named a "zem"), and were instructed to play with the object pairs with their child one at a time, "as they typically would." All parents confirmed that their child had not previosuly seen the novel toys and were instructed to use the novel labels to refer to the novel toys.  

The experimenter then left the playroom for approximately 15 minutes, during which a tripod-mounted camera in the corner of the room recorded the session and the headcam captured video from the child's perspective.

## Data Processing and Annotation

\begin{figure*}
\includegraphics[width=6in]{images/framesample.pdf}
\caption{\label{fig:frames} Example face detections made by MTCNN for the headcam videos from a child in each group  (green squares).}
\end{figure*}

Headcam videos were trimmed such that they excluded the instruction phase when the experimenter was in the room and were automatically synchronized with the tripod-mounted videos using FinalCut Pro Software. These sessions yielded videos of 
`r round(sum(inc_subs$len.min), digits = 0)` minutes (almost a milion frames), with an average video length of
`r round(sum(inc_subs$len.min)/60, digits = 2)` minutes
(min = `r round(min(inc_subs$len.min), digits = 2)`, max = `r round(max(inc_subs$len.min), digits = 2)`).

### Posture and Orientation Annotation

We created a set of custom annotations that described the child's physical posture (e.g. standing) and the orientation of the caregiver relative to the child (e.g. far away). The child's posture was categorized as being held/carried, prone (crawling or lying), sitting, or standing. The caregiver's orientation was characterized as being close to the child, farther from the child, and a global category of caregiver behind the child. For the first two annotationes (close/far from the child), the caregiver could either be to the the front or to the side of the child. All annontations were made using OpenSHAPA/Datavyu software  [@adolph2012], and times when the child was out of view of the tripod camera was marked as uncodable and was excluded from these annotations. 

## Face Detection
Measuring the availability of caregiver’s faces across development was an important goal of the study. We used a total of three face detection systems to explore this hypothesis and to avoid the cost of hand-annotating every frame. Results for the evaluation of these three systems are shown in Table X.

### Face Detection Algorithms
The first face detection system made use of a series of Haar feature-based cascade classifiers (Viola-Jones, CITEXX) applied to each individual frame. This detector provided information about the presence of a face as well as its size and position. 

The second algorithm was based on the work by (CITEXX) using multi-task cascaded convolutional neural networks (MTCNNs). The system was built using a novel cascaded CNN-based framework for joint detection and alignment, built to perform well in real-world environments where varying illuminations and occlusions are present. We used a Tensorflow implementation of this algorithm provided by (https://github.com/davidsandberg/facenet)

The third algorithm was a CNN-based pose detector that provided the locations of 18 body parts (ears, nose, wrists, etc) (CITEXX). The system uses a CNN for initial anatomical detection and subsequently applies part affinity fields (PAFs) for part association, producing a series of body part candidates. The candidates are then matched to a single individual and finally assembled into a pose. For the purposes of our investigation we only made use of the body parts relevant to the face (ears, eyes, nose).

### Detector evaluation


\begin{table}[t]
  \caption{Model performance on gold standard generalization training set dataset. P, R, and F denote precision, recall, and F-score for each of the two samples. \label{tab:model_eval}}
  \begin{center}
    \begin{tabular}{l|ccc|ccc}
      \hline
       &  \multicolumn{3}{c|}{High-density} &  \multicolumn{3}{c}{Random} \\
      % \null Model & P & R & F & P & R & F  \\
      \hline
      % Viola-Jones & .55  & .38 &  .45 & .89 & .74 & .81   \\
      % MTCNN & .86 & .78 & .81 & .93 & .76 & .83 \\
      % OpenPose-Faces & .86 & .78 & .81 & .93 & .76 & .83 \\
      % OpenPose-Wrists & .86 & .78 & .81 & .93 & .76 & .83 \\
      % OpenPose-Hands & .86 & .78 & .81 & .93 & .76 & .83 \\
    \hline
    \end{tabular}
  \end{center}
\end{table}

# Results
We report results from three different sets of analyses. First, we explore how these changes affect access to faces and to hands, as measured using computater vision algorithms. Second, we explore how these changes impact the accessibility of faces and hands during labeling events.

```{r}
d <- read_csv("../data/consolidateddata/consolidated_data_3dets.csv") %>%
  mutate(posture = factor(posture), orientation = factor(orientation))

## make long form version for plotting
dlong <- d %>%
  mutate(id = paste(subid,frame)) %>%
  gather(key = detectorType, value = face, faceMT, faceOP)

facebyAge <- dlong %>%
  filter(!is.na(age.at.test)) %>%
  group_by(subid, age.at.test, detectorType) %>%
  summarise(face = mean(face)) %>%
  left_join(inc_subs) %>%
  mutate(len = as.numeric(len_seconds/60))

faceByOrientation <- dlong %>%
  filter(!is.na(orientation)) %>%
  group_by(age.grp, orientation, subid, detectorType) %>%
  summarise(face = mean(face)) %>%
  group_by(age.grp)

facebyPosture <- dlong %>%
  filter(!is.na(posture)) %>%
  group_by(age.grp, posture, subid,detectorType) %>%
  summarise(face = mean(face)) %>%
  group_by(age.grp)
```

# Changes in Access to Faces
```{r fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=4, fig.height=3, fig.cap = "R plot" }

  ggplot(facebyAge, aes(x = age.at.test, y = face, color = detectorType, size = len)) +
    geom_jitter(width = .25) + 
    geom_smooth() +
    scale_x_continuous(breaks=c(8,12,16)) +
    scale_size_continuous(range=c(1,4),name = "Video Length (mins)") + 
    ylab("Proportion Face Detections") + 
    xlab("Age (months)") + 
    theme_bw() +
    theme(legend.position="bottom", legend.box = "horizontal")
    
```

```{r faceByPostureFig, fig.env="figure*", fig.pos = "h", fig.align = "center", num.cols.cap=2, fig.width=6, fig.height=2, fig.cap = "Proportion of face detections as a function of infant's posture, using the MTCNN3 detections (left panel) and OpenPose detections (right panel)"}
ggplot(facebyPosture, aes(x = factor(age.grp), y = face, col = posture)) + 
  geom_boxplot() + 
  ylab("Proportion Face Detections") + 
  xlab("Age (months)") + 
  facet_grid(~detectorType) +
  theme_bw()

```
  
```{r faceByOrientFig, fig.env="figure*", fig.pos = "h", fig.align = "center", num.cols.cap=2, fig.width=6, fig.height=2, fig.cap = "Proportion of face detections as a function of caregiver's orientation,using the MTCNN3 detections (left panel) and OpenPose detections (right panel)" }
ggplot(faceByOrientation, aes(x = factor(age.grp), y = face, col = orientation)) + 
  geom_boxplot() + 
  ylab("Proportion Face Detections") + 
  xlab("Age (months)") + 
  facet_grid(~detectorType) +
  theme_bw() 
  # theme(legend.position="bottom", legend.box = "horizontal")

```

<!-- ## Model -->

<!-- # ```{r} -->
<!-- # d$faceNum=as.numeric(d$faceMT) -->
<!-- # -->
<!-- # # Fails to converge -->
<!-- # # fullModel <- glmer(is_face ~ scale(age.at.test)*(posture) *(orientation) + (1|subid), -->
<!-- # #       data = d, -->
<!-- # #       family = "binomial") -->
<!-- # -->
<!-- # # Fails to converge -->
<!-- # # agexOrientation <- glmer(faceNum ~ scale(age.at.test) * orientation + (1|subid), -->
<!-- # #       data = d, -->
<!-- # #       family = "binomial") -->
<!-- # -->
<!-- # fullModelminsInt <- glmer(faceNum ~ scale(age.at.test) + posture + orientation + (1|subid), -->
<!-- #        data = d, -->
<!-- #        family = "binomial") -->
<!-- # -->
<!-- # ageOnly <- glmer(faceNum ~ scale(age.at.test) + (1|subid), -->
<!-- #       data = d, -->
<!-- #       family = "binomial") -->
<!-- # -->
<!-- # ``` -->

To formalize these observations, we fit a generalized logistic mixed-effect model to all with the presence/absence of a face on every frame (as detected by the MTCNN3 model) as the dependent variable, and participant's age, orientation, and posture as predictors. Interactions between predictors were not included as this maximal model failed to converge. A summary of the coefficients of this model can be found in Table {ref}. While age remained a significant predictor even when accounting for the effects of infants' posture and caregiver's oirentation, it held relativley less predictive power. Overall, these results confirm that infant's access to faces is heavily infleunced by their own posture and their caregivers orientation towards them.

<!-- ```{r xtable, results="asis"} -->
<!-- tab2 <- xtable::xtable(summary(fullModelminsInt)$coef, digits=3,  -->
<!--                       caption = "Results from GLMM model prediting the presence/absence of a face across                       the entire dataset.") -->

<!-- print(tab2, type="latex", comment = F, table.placement = "H") -->
<!-- ``` -->

\begin{table}[H]
\centering
\begin{tabular}{rrrrr}
  \hline
 & Estimate & Std. Error & z value & Pr($>$$|$z$|$) \\ 
  \hline
(Intercept) & -4.846 & 0.077 & -62.682 & 0.000 \\ 
  Age & 0.170 & 0.061 & 2.766 & 0.006 \\ 
  Posture-Prone & -0.513 & 0.036 & -14.045 & 0.000 \\ 
  Posture-Sit & 0.648 & 0.034 & 18.853 & 0.000 \\ 
  Posture-Stand & 1.005 & 0.035 & 28.402 & 0.000 \\ 
  Orient.-Close & 1.549 & 0.021 & 72.757 & 0.000 \\ 
  Orient.-Far & 2.258 & 0.022 & 101.138 & 0.000 \\ 
   \hline
\end{tabular}
\caption{Results from GLMM model prediting the presence/absence of a face across                       the entire dataset.} 
\end{table}

# Changes in Access to Hands

Next, we examined whether we would see similar trends in infant and children's access to hands. 

# General Discussion
We use a head-mounted camera to explore how children's postural and locomotive development directly impacts their access to social information relevant for word-learning, here operationalized as the presence of the faces and hands of their caregiver. We found that children's posture and orientation towards their caregiver changed systematically across age, and that all three of these factors dramatically impacted the proportion of faces and hands that were avaliable in the child's visual field. Thus, infants postural development is mediating factor that explains age-related changes in the proportion of faces and hands avaliable in infants' visual field.

This work also deploys novel advancements in computer vision to the study of developmental psychology. The field of object detection and recognition has advanced dramatically in the past five years since the re-birth of deep learning algorithms (Krihevsky et al., 2012), creating a new generation of algorithmic tools that both are substantially better equipped to deal with noisier, more complicated datasets and that can  extract richer and more detailed information. Indeed, these videos from the infant perspective provided sustantial challenges (e.g., partially occluded faces) for the classc models of face detedction (e.g., viola jones).   Further, as the headcam technologies employed here were inexpensive (~$60 a camera) and the computer vision algorithms freely avaliable, this method is a promising avenue for quanitfying the visual and social information avaliable to new infant learners. 

Thus, we suggest that the combined use of these new tools can be leveraged to understand the changing infant perspecive on the visual world and the implications of these changes for both linguistic, cognitive, and social development.

# Acknowledgements

Thanks to Kaia Simmons, Kathy Woo, Aditi Maliwal, and other members of the Language and Cognition Lab for help in recruitment, data collection, and annotation. This research was supported by a John Merck Scholars grant to MCF. An earlier version of this work was presented to the Cognitive Science Society in @frank2013. Please address correspondence to Michael C. Frank, Department of Psychology, Stanford University, 450 Serra Mall (Jordan Hall), Stanford, CA, 94305, tel: (650) 724-4003, email: \texttt{mcfrank@stanford.edu}.

# References 

```{r}
# References will be generated automatically by Pandoc and included here.
# The following code is some latex to format the bibliography. Do not remove it.
```

\setlength{\parindent}{-0.1in} 
\setlength{\leftskip}{0.125in}
\noindent
