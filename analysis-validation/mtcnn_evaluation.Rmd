---
title: "mtcnn evaluation"
output: html_document
---

500 frames were taken across all groups, half of them labeled as containing a face and half with no face.

Load data
```{r, message=FALSE, warning=FALSE}
setwd("..")
data <- read_csv("data/final_output/mtcnn3.csv") %>%
  distinct(video, frame, .keep_all = TRUE)

ground_truth_data <- read_csv("data/ground_truth/ground_truth3.csv") %>%
  select(-angle)
```

Join
```{r}
combined <- data %>%
  rename(detector_is_face = is_face) %>%
  inner_join(ground_truth_data, by = c("group", "video", "frame"))
```

Eval function
```{r}
evaluate <- function(a, b) {
  if (a == "True") {
    if (a == b) return ("TP")
    else return("FN")
  }
  else {
    if (a == b) return("TN")
    else return("FP")
  }
}
```

Evaluate
```{r}
results <- combined %>%
  rowwise() %>%
  mutate(result = evaluate(is_face, detector_is_face))
```

Precison / Recall / F-score
```{r}
score <- results %>%
  group_by(result) %>%
  summarise(count = n())

p <- score[4,2] / (score[4,2] + score[2,2])
r <- score[4,2] / (score[4,2] + score[1,2])
f <- 2 * p * r / (p + r)

print(paste("P:", round(p,3), "R:", round(r,3), "F:", round(f,3)))
```

